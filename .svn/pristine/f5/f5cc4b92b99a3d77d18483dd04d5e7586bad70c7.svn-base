/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

var seconddata = "";
$(document).ready(function () {
    var firstdata = $(".leaderboardendorsedtable").html();
    var activeTab = null;
    $('a[data-toggle="tab"]').on('click', function (e) {
        $("#datepicker_startdate").val("");
        $("#datepicker_enddate").val("");
        activeTab = $(e.target).attr("id");
        $("#setleaderboardendorseddata").attr("data-type", activeTab);
        if (activeTab == "endorser") {
            if (seconddata.length > 0) {
                $(".leaderboardendorsedtable").html("");
                $(".leaderboardendorsedtable").html(seconddata);
            } else {
                var type = activeTab;
                $.ajax({
                    type: "POST",
                    url: siteurl + 'cajax/getdataleaderboard',
                    data: {type: type},
                    success: function (data, textStatus, xhr) {
                        seconddata = data;
                        console.log(data);
                        $(".leaderboardendorsedtable").html("");
                        if (data.length > 0) {
                            $(".leaderboardendorsedtable").html(data);
                        } else {
                            $(".leaderboardendorsedtable").html('<tbody><tr class="table-head"><td class="nodataavailable">No Data Available</td></tr></tbody>');
                        }
                    },
                });
            }

        } else if (activeTab == "endorsed") {
            $(".leaderboardendorsedtable").html("");
            $(".leaderboardendorsedtable").html(firstdata);
        }
    })


    //====initial data set to variable

    //=clearing values for dates initially
    $("#datepicker_startdate").val("");
    $("#datepicker_enddate").val("");

    //=======setting leaderboard data
    $("#setleaderboardendorseddata").click(function () {
        var startdate = $("#datepicker_startdate").val();
        var enddate = $("#datepicker_enddate").val();
        var type = $(this).attr("data-type");
        if (enddate.length == 0 || startdate.length == 0) {
            alertbootbox("Both dates need to be filled.");
        } else {
            $.ajax({
                type: "POST",
                url: siteurl + 'cajax/getdataleaderboard',
                data: {type: type, startdate: startdate, enddate: enddate},
                success: function (data, textStatus, xhr) {
                    $(".leaderboardendorsedtable").html("");
                    if (data.length > 0) {
                        $(".leaderboardendorsedtable").html(data);
                    } else {
                        $(".leaderboardendorsedtable").html('<tbody><tr class="table-head"><td class="nodataavailable">No Data Available</td></tr></tbody>');
                    }
                },
            });
        }

    })
    //=======end setting leaderboard data

    $("#resetdates").click(function () {
        var getdatatype = $("#setleaderboardendorseddata").attr("data-type");
        $("#datepicker_startdate").val("");
        $("#datepicker_enddate").val("");
        $(".leaderboardendorsedtable").html("");
        if (getdatatype == "endorsed") {
            $(".leaderboardendorsedtable").html(firstdata);
        } else if (getdatatype == "endorser") {
            $(".leaderboardendorsedtable").html(seconddata);
        }

    });
});

